/*
 *
 * Copyright 2014 Tony Quetano under the terms of the MIT
 * license found at https://github.com/planttheidea/sup/MIT_License.txt
 *
 * sup.js - A simple publish / subscribe library without dependencies
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
*/
(function(k,r){function m(a){var b=a.data||{},c,d;if(!e[a.topic])return!1;for(d=(c=e[a.topic])?c.length:0;d--;)c[d].func(b,a.topic);return this}function g(a){if(0<d[a])for(var b in e)if(e[b])for(var c=e[b].length;c--;)e[b][c].token===d[a]&&(delete d[a],e[b].splice(c,1))}function n(a){switch(h(a.name)){case "string":g(a.name);break;case "array":for(var b=a.name.length;b--;)g(a.name[b]);break;default:f("Name passed is not of valid type.")}return this}function l(a,b,c,d,f){"array"!==h(e[a])&&(e[a]=[]);
d&&(c=function(){c.call();g(f)});e[a].push({token:b,func:c})}function p(a){if("string"!==h(a.name))return f("Name passed is not a string."),!1;d[a.name]&&g(a.name);switch(h(a.topic)){case "string":l(a.topic,a.token,a.fn,a.once,a.name);break;case "array":for(var b=a.topic.length;b--;)l(a.topic[b],a.token,a.fn,a.once,a.name);break;case "undefined":f("Must provide a topic to subscribe to.");break;default:f("Invalid topic type, must be either string or array.")}d[a.name]=++q;return this}var e={},d={},
q=-1,f=function(a){throw Error(a);},h=function(a){return Object.prototype.toString.call(a).replace(/^\[object (.+)\]$/,"$1").toLowerCase()};k.Sup?f("Window object of Sup already exists."):k.Sup={publish:m,subscribe:p,unsubscribe:n}})(window,document);
